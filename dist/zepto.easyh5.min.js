/*! zepto.easyh5 作者:zhongwang；日期:2016-04-15；email:webzhongwang@gmail.com；*/
!function(a,c){function d(a,b,c){var d=null;b>0&&(d=a.find(".easyh5-pre")),0>b&&(d=a.find(".easyh5-next")),d.addClass("easyh5-active");var f=b>0?b-a.height():b+a.height();d.css({"-webkit-transform":"translateY("+f+"px);",transform:"translateY("+f+"px);"}),e(d)}function e(b){var c=a(b.find("[delay]"));a.each(c,function(b,c){var d=a(c),e=parseFloat(d.attr("delay"))?parseFloat(d.attr("delay")):0;d.addClass(d.attr("data-class")),c.style.webkitAnimationDelay=e+"s",c.style.animationDelay=e+"s"})}function f(a){this.ininSetting(a),this.initEvent()}function g(a,b){this.$node=a,f.call(this,b)}if("undefined"==typeof a)throw new Error("Easyh5 requires Zepto");var h=null,i={start:0,duration:300,loop:!0,width:320,height:480,persent:.15};g.prototype={initEvent:function(){var b=this,e=b.$node;e.on("touchstart",function(a){b.startX=a.targetTouches[0].clientX,b.startY=a.targetTouches[0].clientY,b.resetStyle(),b.resetClass()}),e.on("touchend",function(a){var c=a.changedTouches[0].clientY-b.startY,d=c/e.height(),f=0;Math.abs(d)>=b.options.persent&&(0>d&&(f=1),d>0&&(f=-1)),b.checkLoop(c)&&b.moveTo(b.settings.currentIndex+f)}),e.on("touchmove",function(a){a.stopPropagation(),a.preventDefault();var c=a.changedTouches[0].clientY-b.startY;b.checkLoop(c)&&d(e,c,b)}),a(c).on("orientationchange",function(a){b.resetView()})},ininSetting:function(b){var c=this,d=c.$node;c.options=a.extend({},i,b),c.settings={currentIndex:c.options.start,page:".easyh5-page"},c.settings.size=d.find(c.settings.page).length,c.initArrow(),c.resetContent(),c.resetView(),c.resetPlacement();var f=a(c.$node.find(this.settings.page)[c.settings.currentIndex]);f.addClass("easyh5-current"),e(f)},initArrow:function(){var a='<div class="easyh5-arrow">                         <div class="easyh5-arrow-in">                             <span class="easyh5-arrow-l"><i></i></span>                             <span class="easyh5-arrow-r"><i></i></span>                         </div>                     </div>';this.$node.append(a)},resetView:function(){var c=this,d=c.$node,e=a(d.find(".easyh5-content")),f=c.options.width,g=c.options.height;windowWidth=d.width(),windowHeight=d.height(),scale=1,b=f/g,windowB=windowWidth/windowHeight,dl=(windowWidth-f)/2,dt=(windowHeight-g)/2,e.css({width:f,height:g}),b<=windowB?scale=windowHeight/g:scale=windowWidth/f,e.css({left:dl+"px",top:dt+"px","-webkit-transform":"scale("+scale+")",transform:"scale("+scale+")"})},resetPlacement:function(){var b=this,c=b.$node,d=a(c.find(this.settings.page)),e=b.settings.currentIndex,f=e-1,g=e+1;0>f&&(f=b.settings.size-1),g>=b.settings.size&&(g=0),a(c.find(".easyh5-pre")).removeClass("easyh5-pre"),a(c.find(".easyh5-next")).removeClass("easyh5-next"),a(d[f]).addClass("easyh5-pre"),a(d[g]).addClass("easyh5-next"),b.clearPageAnim(a(d[f])),b.clearPageAnim(a(d[g]))},resetStyle:function(){a(this.$node.find(this.settings.page)).css({"-webkit-transition":"",transition:""})},resetClass:function(){a(this.$node.find(".easyh5-active")).removeClass("easyh5-active"),a(this.$node.find(".easyh5-anim")).removeClass("easyh5-anim")},resetContent:function(){var b=this.$node,c=b.find(".easyh5-page");a.each(c,function(b,c){var d=c.innerHTML;a(c).html('<div class="easyh5-content"></div>'),a(a(c).find(".easyh5-content")).html(d)})},checkLoop:function(a){var b=!0;return this.options.loop||(0==this.settings.currentIndex&&a>0&&(b=!1),this.settings.currentIndex==this.settings.size-1&&0>a&&(b=!1)),b},clearPageAnim:function(b){$eles=a(b.find("[delay]")),a.each($eles,function(b,c){var d=a(c),e=d.attr("data-class"),f=d.attr("class");f=f.replace(e,""),c.className=f}),$eles.css({"-webkit-animation":"","animation-delay":""})},moveTo:function(b){var c=this,d=c.$node;if(b==c.settings.currentIndex)a(d.find(".easyh5-active")).addClass("easyh5-anim").css({"-webkit-transform":"",transform:""}),setTimeout(function(){c.resetPlacement()},c.options.duration);else{0>b&&(b=c.settings.size-1),b>=c.settings.size&&(b=0),c.settings.currentIndex=b;var e=a(d.find(this.settings.page)[b]);e.addClass("easyh5-active"),e.css({"-webkit-transition":"-webkit-transform "+c.options.duration/1e3+"s ease-in-out",transition:"transform "+c.options.duration/1e3+"s ease-in-out","-webkit-transform":"translateY(0);",transform:"translateY(0);"}),setTimeout(function(){a(d.find(".easyh5-current")).removeClass("easyh5-current"),e.addClass("easyh5-current"),e.removeClass("easyh5-active"),c.resetPlacement()},c.options.duration)}}},a.fn.easyh5=function(b){return h||(h=new g(a(this),b)),this}}(Zepto,window);